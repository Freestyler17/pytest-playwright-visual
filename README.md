# Pytest Plugin for Visual Testing with Playwright

Forked from https://github.com/kumaraditya303/pytest-playwright-snapshot.
In addition to snapshot comparison that pytest-playwright-snapshot provides, this plugin enables:
- visual review of mismatches
- creation of snapshots on the first run
- failing on `--update-snapshots` to make users manually review images
- snapshot name argument is not required, `test_name[browser][os].png` is generated by default
- updated folder structure: `snapshots/file_name/test_name/test_name[browser][os].png`

## Installation

```bash
$ pip install pytest-playwright-visual
```

## Usage

This plugin provides a `assert_snapshot` fixture which is used to create snapshots and compare it.

Example:

```python
def test_myapp(page, assert_snapshot):
    page.goto("https://example.com")
    assert_snapshot(page.screenshot())
```
Then, run pytest:
```bash
$ pytest
```
Ths first time you run pytest, snapshots will be created, and you will get the error:

```console
Failed: --> New snapshot(s) created. Please review images
```

The next run, the snapshots comparison will take place. 

To update snapshots, run:

```bash
$ pytest --update-snapshots
```

After updating, tests will fail and you will need to review images again
In case of a mismatch, `snapshot_tests_failures` folder will be created with Actual, Expected and Diff images generated.

##Example

![img.png](img.png)

There is `threshold` kwarg only option which can be used to set the threshold for the comparison of the screenshots and by default it is `0.1`

## License

Apache 2.0 LICENSE
